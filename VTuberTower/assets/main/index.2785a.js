window.__require=function t(e,o,r){function a(c,i){if(!o[c]){if(!e[c]){var l=c.split("/");if(l=l[l.length-1],!e[l]){var s="function"==typeof __require&&__require;if(!i&&s)return s(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+c+"'")}c=l}var m=o[c]={exports:{}};e[c][0].call(m.exports,function(t){return a(e[c][1][t]||t)},m,m.exports,t,e,o,r)}return o[c].exports}for(var n="function"==typeof __require&&__require,c=0;c<r.length;c++)a(r[c]);return a}({Box:[function(t,e,o){"use strict";cc._RF.push(e,"4c0ffg8IUFN/5hCQ38e5fRo","Box");var r,a=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__decorate||function(t,e,o,r){var a,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var i=t.length-1;i>=0;i--)(a=t[i])&&(c=(n<3?a(c):n>3?a(e,o,c):a(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,i=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_isDone=!1,e}return a(e,t),e.prototype.onLoad=function(){this.m_body=this.node.getComponent(cc.RigidBody)},e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t){"wall"==t.node.group&&this.m_gameOverEvent&&this.m_gameOverEvent()},e.prototype.onBeginContact=function(){!this.m_isDone&&this.m_contactEvent&&(this.m_isDone=!0,this.m_contactEvent())},e.prototype.SetGameOverEvent=function(t){this.m_gameOverEvent=t},e.prototype.SetContactEvent=function(t){this.m_contactEvent=t},n([i],e)}(cc.Component));o.default=l,cc._RF.pop()},{}],Define:[function(t,e,o){"use strict";cc._RF.push(e,"46f29Ut8OVHNqdsEz+A+B0T","Define"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function t(){}return t.GameState=cc.Enum({Menu:-1,Idle:-1,Player1:-1,Player2:-1,CheckAwake:-1,End:-1,GameOver:-1}),t.Symbol={akaoni:"prefab/akaoni",akuma:"prefab/akuma",asacoco:"prefab/asacoco",shark:"prefab/shark",sheep:"prefab/sheep",ame1:"prefab/walfie/ame1",ame2:"prefab/walfie/ame2",ame3:"prefab/walfie/ame3",ame4:"prefab/walfie/ame4",ame5:"prefab/walfie/ame5",ame6:"prefab/walfie/ame6",coco1:"prefab/walfie/coco1",fbk1:"prefab/walfie/fbk1",gura1:"prefab/walfie/gura1",ina1:"prefab/walfie/ina1",kiara1:"prefab/walfie/kiara1",mori1:"prefab/walfie/mori1",ollie1:"prefab/walfie/ollie1"},t}();o.default=r,cc._RF.pop()},{}],FiniteState:[function(t,e,o){"use strict";cc._RF.push(e,"33619zgzYJG5oeBTUxlapVV","FiniteState"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function t(t){this.m_currState=0,this.m_nextState=0,this.m_transitTime=0,this.m_toTransit=!0,this.m_forced=!1,this.m_entering=!1,this.m_currState=t,this.m_nextState=t}return t.prototype.Tick=function(){return this.m_toTransit?(this.m_currState=this.m_nextState,this.m_transitTime=(new Date).getTime()/1e3,this.m_toTransit=!1,this.m_forced=!1,this.m_entering=!0):this.m_entering=!1,this.m_currState},t.prototype.NextState=function(t){this.m_forced||(this.m_nextState=t,this.m_toTransit=!0)},t.prototype.Current=function(){return this.m_currState},t.prototype.Elapsed=function(){return(new Date).getTime()/1e3-this.m_transitTime},t.prototype.IsEntering=function(){return this.m_entering},t.prototype.ForceTransit=function(t){this.m_nextState=t,this.m_toTransit=!0,this.m_forced=!0},t}();o.default=r,cc._RF.pop()},{}],GameView:[function(t,e,o){"use strict";cc._RF.push(e,"e2f0fOuSc1H34H7RtNRYHjm","GameView");var r,a=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__decorate||function(t,e,o,r){var a,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var i=t.length-1;i>=0;i--)(a=t[i])&&(c=(n<3?a(c):n>3?a(e,o,c):a(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./common/FiniteState"),i=t("./Define"),l=t("./Box"),s=cc._decorator,m=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_scoreLabel=null,e.m_boxesNode=null,e.m_dropBtn=null,e.m_rotateRight=null,e.m_rotateLeft=null,e.m_touchPanel=null,e.m_gameOver=null,e.m_isOnePlayer=!0,e.m_nowPlayer=1,e.m_nowBox=null,e.m_boxes=[],e.m_isDrop=!1,e.m_isCheck=!1,e.m_score=0,e.m_checkTimeOut=null,e}return a(e,t),e.prototype.onLoad=function(){cc.macro.ENABLE_MULTI_TOUCH=!1,cc.director.getPhysicsManager().enabled=!0,cc.director.getCollisionManager().enabled=!0,this.m_state=new c.default(i.default.GameState.Menu)},e.prototype.start=function(){var t=this;this.SetEvent(),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(e){switch(e.keyCode){case cc.macro.KEY.a:cc.error(t.m_boxesNode.children);break;case cc.macro.KEY.b:for(var o=!1,r=0;r<t.m_boxesNode.children.length;r++)if(t.m_boxesNode.children[r].getComponent(cc.RigidBody).awake){o=!0,cc.error("awake");break}o||cc.error("sleep")}},this)},e.prototype.update=function(){var t=this;switch(this.m_state.Tick(),this.m_state.Current()){case i.default.GameState.Menu:this.m_state.IsEntering()&&(cc.log("GameState:Init"),this.m_state.NextState(i.default.GameState.Idle));break;case i.default.GameState.Idle:this.m_state.IsEntering()&&(cc.log("GameState:Idle"),this.m_nowBox=null,this.m_isDrop=!1,this.m_isCheck=!1,this.m_forceStopTimeOut&&(clearTimeout(this.m_forceStopTimeOut),this.m_forceStopTimeOut=null),this.m_isOnePlayer?this.m_state.NextState(i.default.GameState.Player1):(this.m_nowPlayer=1==this.m_nowPlayer?2:1,1==this.m_nowPlayer?this.m_state.NextState(i.default.GameState.Player2):this.m_state.NextState(i.default.GameState.Player1)));break;case i.default.GameState.Player1:this.m_state.IsEntering()&&(cc.log("GameState:Player1"),this.CreateBox());break;case i.default.GameState.Player2:this.m_state.IsEntering()&&cc.log("GameState:Player2");break;case i.default.GameState.CheckAwake:this.m_state.IsEntering()&&(cc.log("GameState:CheckAwake"),this.m_checkTimeOut=setTimeout(function(){t.m_state.NextState(i.default.GameState.End)},3e3));break;case i.default.GameState.End:this.m_state.IsEntering()&&(cc.log("GameState:End"),this.m_state.NextState(i.default.GameState.Idle));break;case i.default.GameState.GameOver:this.m_state.IsEntering()&&cc.log("GameState:GameOver")}},e.prototype.CreateBox=function(t){var e=this;void 0===t&&(t=null);var o=t||null;if(!o){var r=Math.floor(Math.random()*Object.keys(i.default.Symbol).length);o=i.default.Symbol[Object.keys(i.default.Symbol)[r]]}cc.resources.load(o,null,function(t,o){t&&cc.error(t.message||t);var r=cc.instantiate(o);e.m_boxesNode.addChild(r),r.position=cc.v3(320,970),e.m_nowBox=r,e.m_nowBox.getComponent(l.default).SetGameOverEvent(function(){e.GameOverEvent()}),e.m_nowBox.getComponent(l.default).SetContactEvent(function(){e.ContactEvent()}),e.m_boxes.push(r)})},e.prototype.GameOverEvent=function(){this.m_gameOver.active=!0,this.m_forceStopTimeOut&&(clearTimeout(this.m_forceStopTimeOut),this.m_forceStopTimeOut=null),cc.director.pause()},e.prototype.ContactEvent=function(){this.m_state.NextState(i.default.GameState.CheckAwake)},e.prototype.Restart=function(){null!=this.m_checkTimeOut&&(clearTimeout(this.m_checkTimeOut),this.m_checkTimeOut=null),this.m_gameOver.active=!1,this.m_score=0,this.m_scoreLabel.string=this.m_score.toString(),this.m_boxes.forEach(function(t){t.removeFromParent(),t.destroy(),t=null}),this.m_boxes=[],this.m_state.NextState(i.default.GameState.Idle),cc.director.resume()},e.prototype.SetEvent=function(){var t=this;this.m_touchPanel.on(cc.Node.EventType.TOUCH_START,function(e){if(!t.m_isDrop&&t.m_nowBox){var o=e.getLocationX();t.m_nowBox.position=cc.v3(o,970)}}),this.m_touchPanel.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(!t.m_isDrop&&t.m_nowBox){var o=e.getLocationX();t.m_nowBox.position=cc.v3(o,970)}}),this.m_dropBtn.on(cc.Node.EventType.TOUCH_START,function(){t.m_isDrop||(t.m_dropBtn.scale=.9)}),this.m_dropBtn.on(cc.Node.EventType.TOUCH_END,function(){t.m_isDrop||t.m_state.Current()!=i.default.GameState.Player1&&t.m_state.Current()!=i.default.GameState.Player2||(t.m_dropBtn.scale=1,t.m_score++,t.m_scoreLabel.string=t.m_score.toString(),t.m_nowBox.getComponent(cc.RigidBody).awake=!0,t.m_isDrop=!0,t.m_forceStopTimeOut=setTimeout(function(){t.m_state.NextState(i.default.GameState.End)},1e4))}),this.m_dropBtn.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.m_dropBtn.scale=1}),this.m_rotateRight.on(cc.Node.EventType.TOUCH_START,function(){t.m_isDrop||(t.m_rotateRight.scale=.9,t.m_nowBox.angle+=10,t.m_rotateInterval=setInterval(function(){t.m_nowBox.angle+=10},100))}),this.m_rotateRight.on(cc.Node.EventType.TOUCH_END,function(){t.m_rotateRight.scale=1,t.m_rotateInterval&&(clearInterval(t.m_rotateInterval),t.m_rotateInterval=null)}),this.m_rotateRight.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.m_rotateRight.scale=1,t.m_rotateInterval&&(clearInterval(t.m_rotateInterval),t.m_rotateInterval=null)}),this.m_rotateLeft.on(cc.Node.EventType.TOUCH_START,function(){t.m_isDrop||(t.m_rotateLeft.scale=.9,t.m_nowBox.angle-=10,t.m_rotateInterval=setInterval(function(){t.m_nowBox.angle-=10},100))}),this.m_rotateLeft.on(cc.Node.EventType.TOUCH_END,function(){t.m_rotateLeft.scale=1,t.m_rotateInterval&&(clearInterval(t.m_rotateInterval),t.m_rotateInterval=null)}),this.m_rotateLeft.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.m_rotateLeft.scale=1,t.m_rotateInterval&&(clearInterval(t.m_rotateInterval),t.m_rotateInterval=null)});var e=this.m_gameOver.getChildByName("restart");e.on(cc.Node.EventType.TOUCH_START,function(){e.scale=.9}),e.on(cc.Node.EventType.TOUCH_END,function(){t.Restart(),e.scale=1}),e.on(cc.Node.EventType.TOUCH_CANCEL,function(){e.scale=1})},n([u({type:cc.Label,displayName:"Score",tooltip:"\u5206\u6578"})],e.prototype,"m_scoreLabel",void 0),n([u({type:cc.Node,displayName:"Boxes",tooltip:"\u7bb1\u5b50\u5b58\u653e\u8655"})],e.prototype,"m_boxesNode",void 0),n([u({type:cc.Node,displayName:"DropBtn",tooltip:"\u843d\u4e0b\u6309\u9215"})],e.prototype,"m_dropBtn",void 0),n([u({type:cc.Node,displayName:"RotateRight",tooltip:"\u53f3\u65cb\u8f49\u6309\u9215"})],e.prototype,"m_rotateRight",void 0),n([u({type:cc.Node,displayName:"RotateLeft",tooltip:"\u5de6\u65cb\u8f49\u6309\u9215"})],e.prototype,"m_rotateLeft",void 0),n([u({type:cc.Node,displayName:"TouchPanel",tooltip:"\u89f8\u63a7\u9762\u677f"})],e.prototype,"m_touchPanel",void 0),n([u({type:cc.Node,displayName:"GameOver",tooltip:"\u904a\u6232\u7d50\u675f\u63d0\u793a"})],e.prototype,"m_gameOver",void 0),n([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./Box":"Box","./Define":"Define","./common/FiniteState":"FiniteState"}],LocalStorageManager:[function(t,e,o){"use strict";cc._RF.push(e,"7273aR61oRJEbyiN1sz4bKX","LocalStorageManager"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.SetBool=function(t,e){"boolean"==typeof e?cc.sys.localStorage.setItem(t,e.toString()):cc.error("LocalStorage error: SetBool fault")},t.prototype.GetBool=function(t){var e;return null!=(e=cc.sys.localStorage.getItem(t))?"false"!=e&&("true"==e||(cc.error("LocalStorage error: GetBool fault"),null)):(cc.warn("LocalStorage error: Key not found "),null)},t.prototype.SetInt=function(t,e){"number"==typeof e?cc.sys.localStorage.setItem(t,e.toString()):cc.error("LocalStorage error: SetInt fault")},t.prototype.GetInt=function(t){var e;return null!=(e=cc.sys.localStorage.getItem(t))?isNaN(Number(e))?(cc.error("LocalStorage error: GetInt fault"),null):Number(e):(cc.warn("LocalStorage error: Key not found "),null)},t.prototype.SetString=function(t,e){"string"==typeof e?cc.sys.localStorage.setItem(t,e):cc.error("LocalStorage error: SetString fault")},t.prototype.GetString=function(t){var e;return null!=(e=cc.sys.localStorage.getItem(t))?e:(cc.warn("LocalStorage error: Key not found "),null)},t.prototype.SetObject=function(t,e){"object"==typeof e?cc.sys.localStorage.setItem(t,JSON.stringify(e)):cc.error("LocalStorage error: setObject fault")},t.prototype.GetObject=function(t){var e;if(null==(e=cc.sys.localStorage.getItem(t)))return cc.warn("LocalStorage error: Key not found "),null;try{var o=JSON.parse(e);if(o&&"object"==typeof o)return o}catch(r){return cc.error("LocalStorage error: Value is not object"),null}},t.prototype.RemoveData=function(t){return cc.sys.localStorage.removeItem(t)},t.prototype.ClearData=function(){return cc.sys.localStorage.clear()},t}();o.default=r,cc._RF.pop()},{}]},{},["Box","Define","GameView","FiniteState","LocalStorageManager"]);